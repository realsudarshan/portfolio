@use '../abstracts/' as *;
@use '../abstracts/tokens/tokens' as *;

.projects {
  --auto-grid-min-size: min(100%, 20rem);
  --auto-grid-gap: var(--space-500);
  --region-padding: var(--space-700);

  @include breakpoint('medium') {
    --auto-grid-min-size: min(45%, 22rem);
  }

  @include breakpoint('large') {
    --auto-grid-min-size: min(30%, 24rem);
  }

  .auto-grid {
    align-items: stretch;
  }

  .card {
    display: flex;
    flex-direction: column;
    overflow: hidden;
    padding: var(--space-400);
    max-width: 100%;
    width: 100%;
    height: 100%;
    min-height: 280px;
    border-radius: $border-radius-0-5;
    border: 2px solid rgba(255, 255, 255, 0.1);
    background: rgba(255, 255, 255, 0.02);
    transition: border-color 0.2s, box-shadow 0.2s, background-color 0.2s;

    @media (prefers-color-scheme: light) {
      border-color: rgba(0, 0, 0, 0.15);
      background: rgba(0, 0, 0, 0.02);
    }

    &:hover {
      border-color: $color-border-primary-600;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      background: rgba(255, 255, 255, 0.05);

      @media (prefers-color-scheme: light) {
        background: rgba(0, 0, 0, 0.05);
      }
    }

    p {
      margin-block-end: auto;
      line-height: 1.5;
      flex: 1 1 auto;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 4;
      -webkit-box-orient: vertical;
      line-clamp: 4;
    }

    &-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-block-end: var(--space-300);
      flex-shrink: 0;

      a {
        font-weight: $font-weight-bold;
        font-size: $font-size-400;
      }

      &__star {
        display: flex;
        align-items: center;
        gap: 0.3em;
        text-decoration: 0;
        font-size: $font-size-300;
        color: $color-text-muted;

        &::after {
          all: unset;
        }

        &:hover {
          color: $color-text-body;
        }
      }
    }

    &-foot {
      margin-block-start: auto;
      padding-block-start: var(--space-300);
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      flex-shrink: 0;

      @media (prefers-color-scheme: light) {
        border-top-color: rgba(0, 0, 0, 0.1);
      }

      &__language {
        display: flex;
        align-items: center;
        gap: 0.4em;

        &-color {
          display: block;
          width: 14px;
          height: 14px;
          border-radius: $border-radius-rounded-full;
        }
      }

      &__topics {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        gap: 0.4em;
        margin-block-start: var(--space-200);
      }
    }
  }
}

.posts {
  --auto-grid-min-size: min(54vw, 14rem);
  --auto-grid-gap: var(--space-600);
  --region-padding: var(--space-700);

  .card {
    --gradient-bottom: linear-gradient(0deg,
        rgba(0, 0, 0, 0) 0%,
        rgba(0, 0, 0, 0.15) 50%,
        rgba(0, 0, 0, 0.4) 100%);
    --gradient-full: linear-gradient(0deg,
        rgba(0, 0, 0, 0.5) 0%,
        rgba(0, 0, 0, 0.4) 100%);
  }

  .card {
    --card-text-color: #fff;
    height: rem(300);
    position: relative;
    border-radius: $border-radius-1;
    overflow: hidden;
    box-shadow: rem(14) rem(14) rem(60) rem(-10) rgba(0, 0, 0, 0.3);

    &__image {
      transition: transform 0.2s;
      object-fit: cover;
    }

    &__inner {
      position: absolute;
      inset: 0;
      overflow: hidden;
      border-radius: $border-radius-1;
      padding: var(--space-200);
      color: var(--card-text-color);
      background-image: var(--gradient-full);
    }

    &__link {
      text-decoration: 0;
      word-wrap: break-word;
      overflow-wrap: break-word;
      hyphens: auto;

      &:hover {
        color: var(--card-text-color);
      }
    }

    &__link::after {
      content: '';
      position: absolute;
      inset: 0;
      z-index: 1;
    }

    &__date {
      display: flex;
      align-items: center;
      position: absolute;
      bottom: var(--space-200);
      left: var(--space-200);
    }

    @media (pointer: fine) {
      &__inner {
        background-image: var(--gradient-bottom);
      }

      &:where(:focus-within, :hover) .card__inner {
        background-image: var(--gradient-full);
      }

      &__description {
        pointer-events: none;
        opacity: 0;
        transform: translateY(rem(10));
        transition: opacity 0.2s cubic-bezier(0.4, 0, 0.2, 1),
          transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      }

      &:where(:hover, :focus-within) .card__image {
        transform: scale(1.2, 1.2);
      }

      &:where(:focus-within, :hover) .card__date {
        display: none;
      }

      &:where(:focus-within, :hover) .card__description {
        transform: translateY(0);
        opacity: 1;
      }

      &__image {
        object-position: center top;
      }
    }
  }
}